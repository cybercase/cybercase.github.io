<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Keyboard Shortcuts and Layouts in the Browser</title><meta name="description" content="Defining layout independent keyboard shortcuts in the browser"/><meta property="og:title" content="Keyboard Shortcuts and Layouts in the Browser"/><meta name="og:description" content="Defining layout independent keyboard shortcuts in the browser"/><meta name="og:image" content="https://stefano.brilli.me/images/keyboard.png"/><meta property="og:url" content="https://stefano.brilli.me/blog/javascript_keyboard_shortcuts_in_the_browser/"/><meta property="og:type" content="website"/><meta name="next-head-count" content="9"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="preconnect" href="https://cdnjs.cloudflare.com"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.3/katex.min.css" integrity="sha512-07YhC3P4/vS5HdgGuNAAeIxb5ee//efgRNo5AGdMtqFBUPYOdQG/sDK0Nl5qNq94kdEk/Pvu8pmN4GYUeucUkw==" crossorigin="anonymous" referrerPolicy="no-referrer"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/23b632ecbbf88eb8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/23b632ecbbf88eb8.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-5752944655d749a0.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-250a0b3dc1fc1f02.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08f9979ebc4e297a.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-b964ecc8fc6be6a1.js" defer=""></script><script src="/_next/static/chunks/440-9ab67ee21eaa4db8.js" defer=""></script><script src="/_next/static/chunks/294-5a7641993238b3cf.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-8674bd6fffbba048.js" defer=""></script><script src="/_next/static/c79P0UpIM2BLcn9egbI-A/_buildManifest.js" defer=""></script><script src="/_next/static/c79P0UpIM2BLcn9egbI-A/_ssgManifest.js" defer=""></script><script src="/_next/static/c79P0UpIM2BLcn9egbI-A/_middlewareManifest.js" defer=""></script><style data-emotion="css "></style><style data-href="https://fonts.googleapis.com/css?family=Ubuntu+Mono&display=swap">@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc6CsI.woff) format('woff')}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc3CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc-CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc2CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc5CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc0CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc6CsTYl4BO.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css?family=Roboto:400,100italic,100,300,900&display=swap">@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzAdKQ.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxIIzQ.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxM.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfBBc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEz0dL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzQdL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzwdL-vwnYh2eg.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzMdL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEz8dL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEz4dL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzAdL-vwnYg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxFIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxMIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxEIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxLIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxHIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxGIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxIIzIXKMny.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu72xKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu5mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7GxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css?family=Merriweather:400,400i,700&display=swap">@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZOf-Q.woff) format('woff')}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-fCZK.woff) format('woff')}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZWMf8.woff) format('woff')}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZDf-LVrPHpBXw.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZKf-LVrPHpBXw.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZBf-LVrPHpBXw.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZAf-LVrPHpBXw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZOf-LVrPHp.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-cSZMdeX3rsHo.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-eCZMdeX3rsHo.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-cyZMdeX3rsHo.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-ciZMdeX3rsHo.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-fCZMdeX3rg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZVcf6hPvhPUWH.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZXMf6hPvhPUWH.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZV8f6hPvhPUWH.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZVsf6hPvhPUWH.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZWMf6hPvhPQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><main class="container"><header class="site-header site-header--cover"><nav class="site-header-nav"><a href="/feed.rss" rel="alternate" type="application/rss+xml"><i class="fa fa-rss"></i></a><span></span><a href="/">Home</a><a href="/blog/">Blog</a></nav><div class="cover cover--dark" style="background-image:url(/images/keyboard.png)"><div class="cover-box"><h1 class="cover-box-title">Keyboard Shortcuts and Layouts in the Browser</h1></div></div></header><article class="content blog-article" lang="en"><p>Current DOM specification provides 2 event types for handling keyboard actions<sup><a href="#keypress">[1]</a></sup>:</p>
<ul>
<li><code>keydown</code></li>
<li><code>keyup</code></li>
</ul>
<p>These events match the physical actions of pressing and releasing a key of the keyboard, and have a payload with the
result of <em>keymapping</em><sup><a href="#keymapping">[2]</a></sup> by the OS (or any software in between), taking into account current <em>layout</em>, modifier and dead keys.</p>
<p>The result of <em>keymapping</em> is stored in the <code>key</code> property of the event according to the <em>key algorithm</em><sup><a href="#keyproperty">[3]</a></sup>.
The pressing of a specific key can be caught just by listening for <code>keydown</code> and checking the <code>key</code> prop. e.g.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">let</span> <span class="hljs-title function_">shortcutHandler</span> = (<span class="hljs-params">event</span>) => {
    <span class="hljs-comment">// Shortcut: l</span>
    <span class="hljs-keyword">if</span> (event.<span class="hljs-property">key</span> === <span class="hljs-string">'l'</span>) {
        <span class="hljs-comment">// Simplest case; Facebook use the same shortcut to like items in the feed.</span>
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'"l" is pressed'</span>)
    }
}

<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'keydown'</span>, shortcutHandler)
</code></pre>
<h2>Modifiers</h2>
<p>Keyboard shortcuts may require the combination of a character key and one or more modifiers<sup><a href="#modifier">[4]</a></sup>.
Modifiers like <code>Meta</code> or <code>Ctrl</code> usually don’t have the purpose of altering the unicode produced by a key,
so it’s easy to define and catch a shortcut combination using the modifiers props stored in the event payload. e.g.</p>
<pre><code class="hljs language-csharp"><span class="hljs-keyword">let</span> shortcutHandler = (<span class="hljs-keyword">event</span>) => {
    <span class="hljs-comment">// Shortcut: Meta+c</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">event</span>.key === <span class="hljs-string">'c'</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.metaKey === <span class="hljs-literal">true</span>) {
        <span class="hljs-comment">// The famous "Copy" shortcut on macOS</span>
        console.log(<span class="hljs-string">'"Meta+c" pressed'</span>)
    }
}
</code></pre>
<p>On the other hand <code>Alt</code> and <code>Shift</code> modifiers may alter the unicode produced by a key, leading to issues in shortcut definition and catching. e.g.</p>
<pre><code class="hljs language-vbnet"><span class="hljs-keyword">let</span> shortcutHandler = (<span class="hljs-keyword">event</span>) => {
    // Shortcut: Meta+Shift+s
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">event</span>.<span class="hljs-keyword">key</span> === <span class="hljs-comment">'s' &#x26;&#x26; event.metaKey === true &#x26;&#x26; event.shiftKey) {</span>
        // The <span class="hljs-string">"Save All"</span> shortcut
        console.log(<span class="hljs-comment">'"Meta+Shift+s" pressed')</span>

        // WARNING
        // This won<span class="hljs-comment">'t work becase the "Shift" modifier change the unicode</span>
        // <span class="hljs-keyword">of</span> <span class="hljs-string">"S"</span> <span class="hljs-keyword">key</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"s"</span> (lowercase) <span class="hljs-keyword">to</span> <span class="hljs-string">"S"</span> (uppercase)
    }
}
</code></pre>
<h2>Normalization</h2>
<p>Fixing the previous example is trivial: just replace the lowercase “s” with the uppercase “S” in the shortcut definition.
The new definition considers the effect produced from the <code>Shift</code> modifier, making the code work just fine. e.g.</p>
<pre><code class="hljs language-csharp"><span class="hljs-keyword">let</span> shortcutHandler = (<span class="hljs-keyword">event</span>) => {
    <span class="hljs-comment">// Shortcut: Meta+Shift+S</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">event</span>.key === <span class="hljs-string">'S'</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.metaKey === <span class="hljs-literal">true</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.shiftKey) {
        <span class="hljs-comment">// The Normalized "Save All" shortcut</span>
        console.log(<span class="hljs-string">'"Meta+Shift+S" pressed'</span>)

        <span class="hljs-comment">// This works as expected</span>
    }
}
</code></pre>
<p>Let’s call <strong>Normalization</strong> the action of replacing of the
character key in a keyboard shortcut, with the unicode produced from the same character key plus the modifiers in the shortcut.</p>
<h2>Layouts</h2>
<p>Normalization falls short when considering multiple layouts; in fact it’s layout dependant. e.g.:</p>
<ul>
<li>Normalization<sub>US</sub> for <code>Meta + Shift + 2</code> is <code>Meta + Shift + @</code></li>
<li>Normalization<sub>IT</sub> for <code>Meta + Shift + 2</code> is <code>Meta + Shift + "</code></li>
<li>Normalization<sub>FR</sub> for <code>Meta + Shift + 2</code> is <code>Meta + Shift + 2</code>.</li>
</ul>
<p>This limits the Normalization effectiveness to just the shortcuts that use a character key for which its modified unicode char, according to the shortcut modifiers, is the same across every layout.
Let’s call these shortcuts <em>layout-safe</em>. e.g.:</p>
<ul>
<li>Any lowercase [a-z] letter plus the <code>Shift</code> modifier should produce the uppercase version of that letter in every layout.</li>
</ul>
<h2>Recap</h2>
<p>When definining shortcuts for the browsers and multiple layouts it’s worth considering that:</p>
<ul>
<li>Browsers and OS catch shortcuts too; be aware of collisions.</li>
<li>Browsers don’t provide an API for knowing the current layout.</li>
<li>Some key may not be available on some layouts or may require additional modifiers to produce the same character.</li>
<li>If the shortcut contains a character key, modifiers may change the unicode emitted by the <code>keydown</code> in an unpredictable way.</li>
</ul>
<h2>Workaround Ideas</h2>
<h3>Catch ‘Em All</h3>
<p>Given a shortcut, the idea is to collect its Normalization for every layout and listening for all of them.</p>
<pre><code class="hljs language-csharp"><span class="hljs-keyword">let</span> shortcutHandler = (<span class="hljs-keyword">event</span>) => {
    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">event</span>.key === <span class="hljs-string">'2'</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.metaKey === <span class="hljs-literal">true</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.shiftKey) ||
        (<span class="hljs-keyword">event</span>.key === <span class="hljs-string">'"'</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.metaKey === <span class="hljs-literal">true</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.shiftKey) ||
        (<span class="hljs-keyword">event</span>.key === <span class="hljs-string">'@'</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.metaKey === <span class="hljs-literal">true</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.shiftKey)) {
        <span class="hljs-comment">// This catches the "Meta+Shift+2" on US, IT, and FR layouts</span>
        console.log(<span class="hljs-string">'"Meta+Shift+2" pressed'</span>)
    }
}
</code></pre>
<p>The obvious problem is that every shortcut ends up producing a set of Normalized shortcuts, and if the interesection of these sets is not empty it’s impossible to choose which shortcut was triggered. e.g.</p>
<ol>
<li>Normalization<sub>[US, IT]</sub> for <code>Meta+Shift+=</code> is [<code>Meta+Shift++</code>, <code>Meta+Shift+*</code>]</li>
<li>Normalization<sub>[US, IT]</sub> for <code>Meta+Shift+8</code> is [<code>Meta+Shift+*</code>, <code>Meta+Shift+(</code>]</li>
</ol>
<p>Clearly <code>Meta+Shift+*</code> falls into the intersection, making impossible to know if the source is <code>Meta+Shift+=</code> on IT layout or <code>Meta+Shift+8</code> on US layout.</p>
<h3>Just Ask</h3>
<p>The application can infere the keyboard layout using language and location of the browser. Then the Normalization function for such layout is used for catching shortcuts unambiguosly.</p>
<h3>Recovering Numbers</h3>
<p>Shortcuts with number keys plus modifiers are not <em>layout-safe</em>.
However, the number keys position on the physical layout should be the same for most of Latin script layouts <a href="#latinscript">[6]</a>.
Using the <code>code</code> property of <code>keydown</code> event <a href="#keycode">[5]</a>, should be possible to check for numeric keys without ambiguity,
as the <code>code</code> property returns the keycode before keymapping is applied.</p>
<pre><code class="hljs language-csharp"><span class="hljs-keyword">let</span> shortcutHandler = (<span class="hljs-keyword">event</span>) => {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">event</span>.code === <span class="hljs-string">'Digit2'</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.metaKey === <span class="hljs-literal">true</span> &#x26;&#x26; <span class="hljs-keyword">event</span>.shiftKey) {
        <span class="hljs-comment">// This also catches "Meta+Shift+2" on Latin Script based layouts</span>
        console.log(<span class="hljs-string">'"Meta+Shift+2" pressed'</span>)
    }
}
</code></pre>
<h3>Further readings</h3>
<ul>
<li>Internationalize your keyboard controls by Julien Wajsberg, Mozilla Hacks, <a href="https://hacks.mozilla.org/2017/03/internationalize-your-keyboard-controls/" target="_blank"><a href="https://hacks.mozilla.org/2017/03/internationalize-your-keyboard-controls/">https://hacks.mozilla.org/2017/03/internationalize-your-keyboard-controls/</a></a></li>
<li>Can I Use KeyboardEvent.key, Can I Use, <a target="_blank" href="https://caniuse.com/#feat=keyboardevent-key"><a href="https://caniuse.com/#feat=keyboardevent-key">https://caniuse.com/#feat=keyboardevent-key</a></a></li>
<li>Can I Use KeyboardEvent.code, Can I Use, <a target="_blank" href="https://caniuse.com/#feat=keyboardevent-code"><a href="https://caniuse.com/#feat=keyboardevent-code">https://caniuse.com/#feat=keyboardevent-code</a></a></li>
</ul>
<h3>References</h3>
<ol>
<li>Keypress Event Types - DOM 3 Level Specifications, W3C, <a href="https://www.w3.org/TR/DOM-Level-3-Events/#events-keyboard-types" target="_blank" id="keypress"><a href="https://www.w3.org/TR/DOM-Level-3-Events/#events-keyboardevents">https://www.w3.org/TR/DOM-Level-3-Events/#events-keyboardevents</a></a></li>
<li>Key Mapping, W3C, <a href="https://www.w3.org/TR/DOM-Level-3-Events/#key-mapping" target="_blank" id="keymapping"><a href="https://www.w3.org/TR/DOM-Level-3-Events/#key-mapping">https://www.w3.org/TR/DOM-Level-3-Events/#key-mapping</a></a></li>
<li><code>key</code> Property of KeyboardEvent, W3C, <a href="https://www.w3.org/TR/DOM-Level-3-Events/#key-algorithm" target="_blank" id="keyproperty"><a href="https://www.w3.org/TR/DOM-Level-3-Events/#key-algorithm">https://www.w3.org/TR/DOM-Level-3-Events/#key-algorithm</a></a></li>
<li>Modifier Key, Wikipedia, <a href="https://en.wikipedia.org/wiki/Modifier_key" target="_blank" id="modifier"><a href="https://en.wikipedia.org/wiki/Modifier_key">https://en.wikipedia.org/wiki/Modifier_key</a></a></li>
<li>Key Codes, W3C, <a href="https://www.w3.org/TR/DOM-Level-3-Events/#keys-codevalues" target="_blank" id="keycode"><a href="https://www.w3.org/TR/DOM-Level-3-Events/#keys-codevalues">https://www.w3.org/TR/DOM-Level-3-Events/#keys-codevalues</a></a></li>
<li>QWERTY-based layouts for Latin script, Keyboard Layout, Wikipedia, <a href="https://en.wikipedia.org/wiki/Keyboard_layout#QWERTY-based_layouts_for_Latin_script" target="_blank" id="latinscript"><a href="https://en.wikipedia.org/wiki/Keyboard_layout#QWERTY-based_layouts_for_Latin_script">https://en.wikipedia.org/wiki/Keyboard_layout#QWERTY-based_layouts_for_Latin_script</a></a></li>
</ol>
<p><em>— 22/05/2017</em></p></article><footer class="footer"><div class="footer-contacts"><a href="https://twitter.com/thecybercase" target="_blank" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a href="https://github.com/cybercase" target="_blank" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://it.linkedin.com/pub/stefano-brilli/21/650/953" target="_blank" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a href="mailto:stefano@brilli.me"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a></div><div>© Stefano Brilli. All Rights Reserved.</div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"javascript_keyboard_shortcuts_in_the_browser","title":"Keyboard Shortcuts and Layouts in the Browser","description":"Defining layout independent keyboard shortcuts in the browser","date":"2017-05-22T00:00:01.000Z","coverImage":"/images/keyboard.png","coverTitle":"Keyboard Shortcuts and Layouts in the Browser","coverDark":true,"content":"\u003cp\u003eCurrent DOM specification provides 2 event types for handling keyboard actions\u003csup\u003e\u003ca href=\"#keypress\"\u003e[1]\u003c/a\u003e\u003c/sup\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ekeydown\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekeyup\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThese events match the physical actions of pressing and releasing a key of the keyboard, and have a payload with the\nresult of \u003cem\u003ekeymapping\u003c/em\u003e\u003csup\u003e\u003ca href=\"#keymapping\"\u003e[2]\u003c/a\u003e\u003c/sup\u003e by the OS (or any software in between), taking into account current \u003cem\u003elayout\u003c/em\u003e, modifier and dead keys.\u003c/p\u003e\n\u003cp\u003eThe result of \u003cem\u003ekeymapping\u003c/em\u003e is stored in the \u003ccode\u003ekey\u003c/code\u003e property of the event according to the \u003cem\u003ekey algorithm\u003c/em\u003e\u003csup\u003e\u003ca href=\"#keyproperty\"\u003e[3]\u003c/a\u003e\u003c/sup\u003e.\nThe pressing of a specific key can be caught just by listening for \u003ccode\u003ekeydown\u003c/code\u003e and checking the \u003ccode\u003ekey\u003c/code\u003e prop. e.g.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e \u003cspan class=\"hljs-title function_\"\u003eshortcutHandler\u003c/span\u003e = (\u003cspan class=\"hljs-params\"\u003eevent\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Shortcut: l\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (event.\u003cspan class=\"hljs-property\"\u003ekey\u003c/span\u003e === \u003cspan class=\"hljs-string\"\u003e'l'\u003c/span\u003e) {\n        \u003cspan class=\"hljs-comment\"\u003e// Simplest case; Facebook use the same shortcut to like items in the feed.\u003c/span\u003e\n        \u003cspan class=\"hljs-variable language_\"\u003econsole\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'\"l\" is pressed'\u003c/span\u003e)\n    }\n}\n\n\u003cspan class=\"hljs-variable language_\"\u003edocument\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003eaddEventListener\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e'keydown'\u003c/span\u003e, shortcutHandler)\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eModifiers\u003c/h2\u003e\n\u003cp\u003eKeyboard shortcuts may require the combination of a character key and one or more modifiers\u003csup\u003e\u003ca href=\"#modifier\"\u003e[4]\u003c/a\u003e\u003c/sup\u003e.\nModifiers like \u003ccode\u003eMeta\u003c/code\u003e or \u003ccode\u003eCtrl\u003c/code\u003e usually don’t have the purpose of altering the unicode produced by a key,\nso it’s easy to define and catch a shortcut combination using the modifiers props stored in the event payload. e.g.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-csharp\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e shortcutHandler = (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Shortcut: Meta+c\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.key === \u003cspan class=\"hljs-string\"\u003e'c'\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.metaKey === \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e) {\n        \u003cspan class=\"hljs-comment\"\u003e// The famous \"Copy\" shortcut on macOS\u003c/span\u003e\n        console.log(\u003cspan class=\"hljs-string\"\u003e'\"Meta+c\" pressed'\u003c/span\u003e)\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOn the other hand \u003ccode\u003eAlt\u003c/code\u003e and \u003ccode\u003eShift\u003c/code\u003e modifiers may alter the unicode produced by a key, leading to issues in shortcut definition and catching. e.g.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-vbnet\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e shortcutHandler = (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e) =\u003e {\n    // Shortcut: Meta+Shift+s\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.\u003cspan class=\"hljs-keyword\"\u003ekey\u003c/span\u003e === \u003cspan class=\"hljs-comment\"\u003e's' \u0026#x26;\u0026#x26; event.metaKey === true \u0026#x26;\u0026#x26; event.shiftKey) {\u003c/span\u003e\n        // The \u003cspan class=\"hljs-string\"\u003e\"Save All\"\u003c/span\u003e shortcut\n        console.log(\u003cspan class=\"hljs-comment\"\u003e'\"Meta+Shift+s\" pressed')\u003c/span\u003e\n\n        // WARNING\n        // This won\u003cspan class=\"hljs-comment\"\u003e't work becase the \"Shift\" modifier change the unicode\u003c/span\u003e\n        // \u003cspan class=\"hljs-keyword\"\u003eof\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"S\"\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ekey\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"s\"\u003c/span\u003e (lowercase) \u003cspan class=\"hljs-keyword\"\u003eto\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"S\"\u003c/span\u003e (uppercase)\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eNormalization\u003c/h2\u003e\n\u003cp\u003eFixing the previous example is trivial: just replace the lowercase “s” with the uppercase “S” in the shortcut definition.\nThe new definition considers the effect produced from the \u003ccode\u003eShift\u003c/code\u003e modifier, making the code work just fine. e.g.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-csharp\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e shortcutHandler = (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-comment\"\u003e// Shortcut: Meta+Shift+S\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.key === \u003cspan class=\"hljs-string\"\u003e'S'\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.metaKey === \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.shiftKey) {\n        \u003cspan class=\"hljs-comment\"\u003e// The Normalized \"Save All\" shortcut\u003c/span\u003e\n        console.log(\u003cspan class=\"hljs-string\"\u003e'\"Meta+Shift+S\" pressed'\u003c/span\u003e)\n\n        \u003cspan class=\"hljs-comment\"\u003e// This works as expected\u003c/span\u003e\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLet’s call \u003cstrong\u003eNormalization\u003c/strong\u003e the action of replacing of the\ncharacter key in a keyboard shortcut, with the unicode produced from the same character key plus the modifiers in the shortcut.\u003c/p\u003e\n\u003ch2\u003eLayouts\u003c/h2\u003e\n\u003cp\u003eNormalization falls short when considering multiple layouts; in fact it’s layout dependant. e.g.:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNormalization\u003csub\u003eUS\u003c/sub\u003e for \u003ccode\u003eMeta + Shift + 2\u003c/code\u003e is \u003ccode\u003eMeta + Shift + @\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eNormalization\u003csub\u003eIT\u003c/sub\u003e for \u003ccode\u003eMeta + Shift + 2\u003c/code\u003e is \u003ccode\u003eMeta + Shift + \"\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eNormalization\u003csub\u003eFR\u003c/sub\u003e for \u003ccode\u003eMeta + Shift + 2\u003c/code\u003e is \u003ccode\u003eMeta + Shift + 2\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis limits the Normalization effectiveness to just the shortcuts that use a character key for which its modified unicode char, according to the shortcut modifiers, is the same across every layout.\nLet’s call these shortcuts \u003cem\u003elayout-safe\u003c/em\u003e. e.g.:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAny lowercase [a-z] letter plus the \u003ccode\u003eShift\u003c/code\u003e modifier should produce the uppercase version of that letter in every layout.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eRecap\u003c/h2\u003e\n\u003cp\u003eWhen definining shortcuts for the browsers and multiple layouts it’s worth considering that:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eBrowsers and OS catch shortcuts too; be aware of collisions.\u003c/li\u003e\n\u003cli\u003eBrowsers don’t provide an API for knowing the current layout.\u003c/li\u003e\n\u003cli\u003eSome key may not be available on some layouts or may require additional modifiers to produce the same character.\u003c/li\u003e\n\u003cli\u003eIf the shortcut contains a character key, modifiers may change the unicode emitted by the \u003ccode\u003ekeydown\u003c/code\u003e in an unpredictable way.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eWorkaround Ideas\u003c/h2\u003e\n\u003ch3\u003eCatch ‘Em All\u003c/h3\u003e\n\u003cp\u003eGiven a shortcut, the idea is to collect its Normalization for every layout and listening for all of them.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-csharp\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e shortcutHandler = (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e ((\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.key === \u003cspan class=\"hljs-string\"\u003e'2'\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.metaKey === \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.shiftKey) ||\n        (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.key === \u003cspan class=\"hljs-string\"\u003e'\"'\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.metaKey === \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.shiftKey) ||\n        (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.key === \u003cspan class=\"hljs-string\"\u003e'@'\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.metaKey === \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.shiftKey)) {\n        \u003cspan class=\"hljs-comment\"\u003e// This catches the \"Meta+Shift+2\" on US, IT, and FR layouts\u003c/span\u003e\n        console.log(\u003cspan class=\"hljs-string\"\u003e'\"Meta+Shift+2\" pressed'\u003c/span\u003e)\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe obvious problem is that every shortcut ends up producing a set of Normalized shortcuts, and if the interesection of these sets is not empty it’s impossible to choose which shortcut was triggered. e.g.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eNormalization\u003csub\u003e[US, IT]\u003c/sub\u003e for \u003ccode\u003eMeta+Shift+=\u003c/code\u003e is [\u003ccode\u003eMeta+Shift++\u003c/code\u003e, \u003ccode\u003eMeta+Shift+*\u003c/code\u003e]\u003c/li\u003e\n\u003cli\u003eNormalization\u003csub\u003e[US, IT]\u003c/sub\u003e for \u003ccode\u003eMeta+Shift+8\u003c/code\u003e is [\u003ccode\u003eMeta+Shift+*\u003c/code\u003e, \u003ccode\u003eMeta+Shift+(\u003c/code\u003e]\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eClearly \u003ccode\u003eMeta+Shift+*\u003c/code\u003e falls into the intersection, making impossible to know if the source is \u003ccode\u003eMeta+Shift+=\u003c/code\u003e on IT layout or \u003ccode\u003eMeta+Shift+8\u003c/code\u003e on US layout.\u003c/p\u003e\n\u003ch3\u003eJust Ask\u003c/h3\u003e\n\u003cp\u003eThe application can infere the keyboard layout using language and location of the browser. Then the Normalization function for such layout is used for catching shortcuts unambiguosly.\u003c/p\u003e\n\u003ch3\u003eRecovering Numbers\u003c/h3\u003e\n\u003cp\u003eShortcuts with number keys plus modifiers are not \u003cem\u003elayout-safe\u003c/em\u003e.\nHowever, the number keys position on the physical layout should be the same for most of Latin script layouts \u003ca href=\"#latinscript\"\u003e[6]\u003c/a\u003e.\nUsing the \u003ccode\u003ecode\u003c/code\u003e property of \u003ccode\u003ekeydown\u003c/code\u003e event \u003ca href=\"#keycode\"\u003e[5]\u003c/a\u003e, should be possible to check for numeric keys without ambiguity,\nas the \u003ccode\u003ecode\u003c/code\u003e property returns the keycode before keymapping is applied.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-csharp\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e shortcutHandler = (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e) =\u003e {\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.code === \u003cspan class=\"hljs-string\"\u003e'Digit2'\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.metaKey === \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e \u0026#x26;\u0026#x26; \u003cspan class=\"hljs-keyword\"\u003eevent\u003c/span\u003e.shiftKey) {\n        \u003cspan class=\"hljs-comment\"\u003e// This also catches \"Meta+Shift+2\" on Latin Script based layouts\u003c/span\u003e\n        console.log(\u003cspan class=\"hljs-string\"\u003e'\"Meta+Shift+2\" pressed'\u003c/span\u003e)\n    }\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eFurther readings\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eInternationalize your keyboard controls by Julien Wajsberg, Mozilla Hacks, \u003ca href=\"https://hacks.mozilla.org/2017/03/internationalize-your-keyboard-controls/\" target=\"_blank\"\u003e\u003ca href=\"https://hacks.mozilla.org/2017/03/internationalize-your-keyboard-controls/\"\u003ehttps://hacks.mozilla.org/2017/03/internationalize-your-keyboard-controls/\u003c/a\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eCan I Use KeyboardEvent.key, Can I Use, \u003ca target=\"_blank\" href=\"https://caniuse.com/#feat=keyboardevent-key\"\u003e\u003ca href=\"https://caniuse.com/#feat=keyboardevent-key\"\u003ehttps://caniuse.com/#feat=keyboardevent-key\u003c/a\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eCan I Use KeyboardEvent.code, Can I Use, \u003ca target=\"_blank\" href=\"https://caniuse.com/#feat=keyboardevent-code\"\u003e\u003ca href=\"https://caniuse.com/#feat=keyboardevent-code\"\u003ehttps://caniuse.com/#feat=keyboardevent-code\u003c/a\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eReferences\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003eKeypress Event Types - DOM 3 Level Specifications, W3C, \u003ca href=\"https://www.w3.org/TR/DOM-Level-3-Events/#events-keyboard-types\" target=\"_blank\" id=\"keypress\"\u003e\u003ca href=\"https://www.w3.org/TR/DOM-Level-3-Events/#events-keyboardevents\"\u003ehttps://www.w3.org/TR/DOM-Level-3-Events/#events-keyboardevents\u003c/a\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eKey Mapping, W3C, \u003ca href=\"https://www.w3.org/TR/DOM-Level-3-Events/#key-mapping\" target=\"_blank\" id=\"keymapping\"\u003e\u003ca href=\"https://www.w3.org/TR/DOM-Level-3-Events/#key-mapping\"\u003ehttps://www.w3.org/TR/DOM-Level-3-Events/#key-mapping\u003c/a\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ekey\u003c/code\u003e Property of KeyboardEvent, W3C, \u003ca href=\"https://www.w3.org/TR/DOM-Level-3-Events/#key-algorithm\" target=\"_blank\" id=\"keyproperty\"\u003e\u003ca href=\"https://www.w3.org/TR/DOM-Level-3-Events/#key-algorithm\"\u003ehttps://www.w3.org/TR/DOM-Level-3-Events/#key-algorithm\u003c/a\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eModifier Key, Wikipedia, \u003ca href=\"https://en.wikipedia.org/wiki/Modifier_key\" target=\"_blank\" id=\"modifier\"\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Modifier_key\"\u003ehttps://en.wikipedia.org/wiki/Modifier_key\u003c/a\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eKey Codes, W3C, \u003ca href=\"https://www.w3.org/TR/DOM-Level-3-Events/#keys-codevalues\" target=\"_blank\" id=\"keycode\"\u003e\u003ca href=\"https://www.w3.org/TR/DOM-Level-3-Events/#keys-codevalues\"\u003ehttps://www.w3.org/TR/DOM-Level-3-Events/#keys-codevalues\u003c/a\u003e\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eQWERTY-based layouts for Latin script, Keyboard Layout, Wikipedia, \u003ca href=\"https://en.wikipedia.org/wiki/Keyboard_layout#QWERTY-based_layouts_for_Latin_script\" target=\"_blank\" id=\"latinscript\"\u003e\u003ca href=\"https://en.wikipedia.org/wiki/Keyboard_layout#QWERTY-based_layouts_for_Latin_script\"\u003ehttps://en.wikipedia.org/wiki/Keyboard_layout#QWERTY-based_layouts_for_Latin_script\u003c/a\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cem\u003e— 22/05/2017\u003c/em\u003e\u003c/p\u003e"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"javascript_keyboard_shortcuts_in_the_browser"},"buildId":"c79P0UpIM2BLcn9egbI-A","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>