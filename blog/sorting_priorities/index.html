<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Sorting Priorities</title><meta name="description" content="Template Sorting in C++"/><meta property="og:title" content="Sorting Priorities"/><meta name="og:description" content="Template Sorting in C++"/><meta property="og:url" content="https://stefano.brilli.me/blog/sorting_priorities/"/><meta property="og:type" content="website"/><meta name="next-head-count" content="8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="preconnect" href="https://cdnjs.cloudflare.com"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.3/katex.min.css" integrity="sha512-07YhC3P4/vS5HdgGuNAAeIxb5ee//efgRNo5AGdMtqFBUPYOdQG/sDK0Nl5qNq94kdEk/Pvu8pmN4GYUeucUkw==" crossorigin="anonymous" referrerPolicy="no-referrer"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="preload" href="/_next/static/css/23b632ecbbf88eb8.css" as="style"/><link rel="stylesheet" href="/_next/static/css/23b632ecbbf88eb8.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-5752944655d749a0.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-250a0b3dc1fc1f02.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08f9979ebc4e297a.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-b964ecc8fc6be6a1.js" defer=""></script><script src="/_next/static/chunks/440-9ab67ee21eaa4db8.js" defer=""></script><script src="/_next/static/chunks/294-5a7641993238b3cf.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-8674bd6fffbba048.js" defer=""></script><script src="/_next/static/gl6wU_kcT8lmZpUDfSzMW/_buildManifest.js" defer=""></script><script src="/_next/static/gl6wU_kcT8lmZpUDfSzMW/_ssgManifest.js" defer=""></script><script src="/_next/static/gl6wU_kcT8lmZpUDfSzMW/_middlewareManifest.js" defer=""></script><style data-emotion="css "></style><style data-href="https://fonts.googleapis.com/css?family=Ubuntu+Mono&display=swap">@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc6CsI.woff) format('woff')}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc3CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc-CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc2CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc5CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc0CsTYl4BOQ3o.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Ubuntu Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/ubuntumono/v15/KFOjCneDtsqEr0keqCMhbCc6CsTYl4BO.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css?family=Roboto:400,100italic,100,300,900&display=swap">@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzAdKQ.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxIIzQ.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxM.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfBBc-.woff) format('woff')}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEz0dL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzQdL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzwdL-vwnYh2eg.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzMdL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEz8dL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEz4dL-vwnYh2eg.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:italic;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOiCnqEu92Fr1Mu51QrEzAdL-vwnYg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxFIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxMIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxEIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxLIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxHIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxGIzIXKMnyrYk.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:100;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOkCnqEu92Fr1MmgVxIIzIXKMny.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu72xKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu5mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7GxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:900;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmYUtfBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css?family=Merriweather:400,400i,700&display=swap">@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZOf-Q.woff) format('woff')}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-fCZK.woff) format('woff')}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZWMf8.woff) format('woff')}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZDf-LVrPHpBXw.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZKf-LVrPHpBXw.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZBf-LVrPHpBXw.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZAf-LVrPHpBXw.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Merriweather';font-style:italic;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4m0qyriQwlOrhSvowK_l5-eRZOf-LVrPHp.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-cSZMdeX3rsHo.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-eCZMdeX3rsHo.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-cyZMdeX3rsHo.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-ciZMdeX3rsHo.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Merriweather';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-440qyriQwlOrhSvowK_l5-fCZMdeX3rg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZVcf6hPvhPUWH.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZXMf6hPvhPUWH.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZV8f6hPvhPUWH.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZVsf6hPvhPUWH.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Merriweather';font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/merriweather/v30/u-4n0qyriQwlOrhSvowK_l52xwNZWMf6hPvhPQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body><div id="__next"><main class="container"><header class="site-header"><nav class="site-header-nav"><a href="/feed.rss" rel="alternate" type="application/rss+xml"><i class="fa fa-rss"></i></a><span></span><a href="/">Home</a><a href="/blog/">Blog</a></nav></header><article class="content blog-article" lang="en"><h1>Sorting Priorities</h1>
<p>Let’s say you have your 3d colored point type:</p>
<pre><code class="hljs language-arduino"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">MyPoint</span>
{
    <span class="hljs-comment">// A 3d colored point</span>
    <span class="hljs-built_in">MyPoint</span>(<span class="hljs-type">int</span> c, <span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y, <span class="hljs-type">int</span> d) :
             <span class="hljs-built_in">color</span>(c), <span class="hljs-built_in">x</span>(x), <span class="hljs-built_in">y</span>(y), <span class="hljs-built_in">d</span>(d) {}
    <span class="hljs-type">int</span> color;
    <span class="hljs-type">int</span> x;
    <span class="hljs-type">int</span> y;
    <span class="hljs-type">int</span> d;
};
</code></pre>
<p>You define a vector of <code>MyPoint</code> objects carefully ordered by color, depth, height and width.</p>
<pre><code class="hljs language-ini">int <span class="hljs-attr">width</span> = <span class="hljs-number">100</span><span class="hljs-comment">;</span>
int <span class="hljs-attr">height</span> = <span class="hljs-number">100</span><span class="hljs-comment">;</span>
int <span class="hljs-attr">depth</span> = <span class="hljs-number">5</span><span class="hljs-comment">;</span>
int <span class="hljs-attr">colors</span> = <span class="hljs-number">2</span><span class="hljs-comment">;</span>

int <span class="hljs-attr">len</span> = width * height * colors * depth<span class="hljs-comment">;</span>
std::vector&#x3C;MyPoint> pts<span class="hljs-comment">;</span>
pts.reserve(len)<span class="hljs-comment">;</span>

for (int <span class="hljs-attr">c</span>=<span class="hljs-number">0</span><span class="hljs-comment">; c&#x3C;colors; ++c)</span>
    for (int <span class="hljs-attr">d</span>=<span class="hljs-number">0</span><span class="hljs-comment">; d&#x3C;depth; ++d)</span>
        for (int <span class="hljs-attr">y</span>=<span class="hljs-number">0</span><span class="hljs-comment">; y&#x3C;height; ++y)</span>
            for (int <span class="hljs-attr">x</span>=<span class="hljs-number">0</span><span class="hljs-comment">; x&#x3C;width; ++x)</span>
                pts.push_back(MyPoint(c, x, y, d))<span class="hljs-comment">;</span>
</code></pre>
<p>Then one of your funny colleagues put a</p>
<pre><code class="hljs language-css">std::<span class="hljs-built_in">random_shuffle</span>(pts.<span class="hljs-built_in">begin</span>(), pts.<span class="hljs-built_in">end</span>());
</code></pre>
<p>just the line before you are scanning the ordered array of <code>MyPoint</code>… If it’s not a colleague, could be that you need to apply a transformation matrix to all of your points, or whatever else that will break the color, depth, height and width ordering of your set.</p>
<p>To order back your vector by the same priorities, you can use the STL sort algorithm with some custom comparison function.
The the first function I wrote was this:</p>
<pre><code class="hljs language-kotlin">bool mypoint_all_sort_fn(<span class="hljs-keyword">const</span> MyPoint&#x26; p0, <span class="hljs-keyword">const</span> MyPoint&#x26; p1)
{
    <span class="hljs-keyword">if</span> (p0.color &#x3C; p1.color)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p0.color == p1.color)
        <span class="hljs-keyword">if</span> (p0.d &#x3C; p1.d)
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p0.d == p1.d)
            <span class="hljs-keyword">if</span> (p0.y &#x3C; p1.y)
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p0.y == p1.y)
                <span class="hljs-keyword">if</span> (p0.x &#x3C; p1.x)
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}
</code></pre>
<p>and then <code>std::sort(pts.begin(), pts.end(), mypoint_all_sort_fn);</code></p>
<p>I found this solution the ugliest among the others. It’s not scalable, has too many indentations and strong code dependancy… And also if <code>mypoint_all_sort_fn</code> was defined as operator inside <code>MyStruct</code> declaration I wouldn’t like to have such a function inside my software.</p>
<p>The second solution I came to was using several <code>stable_sort</code></p>
<pre><code class="hljs language-arduino"><span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">mypoint_x_sort_fn</span><span class="hljs-params">(<span class="hljs-type">const</span> MyPoint&#x26; p0, <span class="hljs-type">const</span> MyPoint&#x26; p1)</span>
</span>{
    <span class="hljs-keyword">return</span> p0.x &#x3C; p1.x;
}
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">mypoint_y_sort_fn</span><span class="hljs-params">(<span class="hljs-type">const</span> MyPoint&#x26; p0, <span class="hljs-type">const</span> MyPoint&#x26; p1)</span>
</span>{
    <span class="hljs-keyword">return</span> p0.y &#x3C; p1.y;
}
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">mypoint_d_sort_fn</span><span class="hljs-params">(<span class="hljs-type">const</span> MyPoint&#x26; p0, <span class="hljs-type">const</span> MyPoint&#x26; p1)</span>
</span>{
    <span class="hljs-keyword">return</span> p0.d &#x3C; p1.d;
}
<span class="hljs-function"><span class="hljs-type">bool</span> <span class="hljs-title">mypoint_c_sort_fn</span><span class="hljs-params">(<span class="hljs-type">const</span> MyPoint&#x26; p0, <span class="hljs-type">const</span> MyPoint&#x26; p1)</span>
</span>{
    <span class="hljs-keyword">return</span> p0.color &#x3C; p1.color;
}
</code></pre>
<p>and then</p>
<pre><code class="hljs language-css">std::<span class="hljs-built_in">stable_sort</span>(pts.<span class="hljs-built_in">begin</span>(), pts.<span class="hljs-built_in">end</span>(), mypoint_x_sort_fn);
std::<span class="hljs-built_in">stable_sort</span>(pts.<span class="hljs-built_in">begin</span>(), pts.<span class="hljs-built_in">end</span>(), mypoint_y_sort_fn);
std::<span class="hljs-built_in">stable_sort</span>(pts.<span class="hljs-built_in">begin</span>(), pts.<span class="hljs-built_in">end</span>(), mypoint_d_sort_fn);
std::<span class="hljs-built_in">stable_sort</span>(pts.<span class="hljs-built_in">begin</span>(), pts.<span class="hljs-built_in">end</span>(), mypoint_c_sort_fn);
</code></pre>
<p>I found this solution not too bad by the code style point of view, but it’s not the same about performances. More are the values you want to sort by, more are the stable_sort steps you have to do.</p>
<p>The last solution, which I found the most fascinating one, was suggested to me by two of my collegues, and it took me a just a small bunch of time to write the code down.</p>
<pre><code class="hljs language-arduino"><span class="hljs-keyword">template</span> &#x3C;<span class="hljs-keyword">typename</span> T> <span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">element</span><span class="hljs-params">(<span class="hljs-type">const</span> T&#x26;, <span class="hljs-type">int</span> i)</span></span>;

<span class="hljs-keyword">template</span> &#x3C;<span class="hljs-keyword">typename</span> T, <span class="hljs-type">int</span> I> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Orderer</span>
{
    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">compare</span><span class="hljs-params">(<span class="hljs-type">const</span> T&#x26; t0, <span class="hljs-type">const</span> T&#x26; t1)</span>
    </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">element</span>(t0, I) == <span class="hljs-built_in">element</span>(t1, I))
            <span class="hljs-keyword">return</span> Orderer&#x3C;T, I<span class="hljs-number">-1</span>>::<span class="hljs-built_in">compare</span>(t0, t1);
        <span class="hljs-keyword">else</span>
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">element</span>(t0, I) &#x3C; <span class="hljs-built_in">element</span>(t1, I);
    }
};
<span class="hljs-keyword">template</span> &#x3C;<span class="hljs-keyword">typename</span> T> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Orderer</span>&#x3C;T, <span class="hljs-number">-1</span>>
{
    <span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">bool</span> <span class="hljs-title">compare</span><span class="hljs-params">(<span class="hljs-type">const</span> T&#x26; t0, <span class="hljs-type">const</span> T&#x26; t1)</span>
    </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
};
</code></pre>
<p>Using templates it’s possible to make the compiler generate the ugly if-else code. Then the task of providing the right element for the sorting is demanded to an element(int) function. Also, it’s possible substitute the element(int) function with an element(int) member function (or maybe an operator) in <code>MyPoint</code> definition. This is how it work:</p>
<pre><code class="hljs language-csharp">template &#x3C;> <span class="hljs-function"><span class="hljs-built_in">int</span> <span class="hljs-title">element</span>&#x3C;<span class="hljs-title">MyPoint</span>>(<span class="hljs-params"><span class="hljs-keyword">const</span> MyPoint&#x26; p, <span class="hljs-built_in">int</span> i</span>)</span>
{
    <span class="hljs-comment">// Watch out!</span>
    <span class="hljs-comment">// The higher is the i-value, the most significant is the member</span>
    <span class="hljs-keyword">switch</span>(i)
    {
        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
            <span class="hljs-keyword">return</span> p.color;
        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
            <span class="hljs-keyword">return</span> p.d;
        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
            <span class="hljs-keyword">return</span> p.y;
        <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
            <span class="hljs-keyword">return</span> p.x;
        <span class="hljs-literal">default</span>:
            <span class="hljs-keyword">throw</span> std::invalid_argument(<span class="hljs-string">"Undefined element"</span>);
    }
}
<span class="hljs-function"><span class="hljs-built_in">bool</span> <span class="hljs-title">mypoint_sort</span>(<span class="hljs-params"><span class="hljs-keyword">const</span> MyPoint&#x26; t0, <span class="hljs-keyword">const</span> MyPoint&#x26; t1</span>)</span>
{
    <span class="hljs-keyword">return</span> Orderer&#x3C;MyPoint, <span class="hljs-number">3</span>>::compare(t0, t1);
}
</code></pre>
<p>and then <code>std::sort(pts.begin(), pts.end(), mypoint_sort);</code></p>
<p>That’s it! A more readable switch-case statement provides the priority of sorting… and the <code>mypoint_sort</code> function call the template right specialization of Orderer Struct static compare function.</p>
<p>Here how you can find, compile and run the code for this example:</p>
<pre><code class="hljs language-bash">git <span class="hljs-built_in">clone</span> git://github.com/cybercase/funproject.git
<span class="hljs-built_in">cd</span> funproject/other
g++ order.cpp -o order -Wall
</code></pre>
<p>One interesting thing I discovered while writing the code of this example, is that you can’t use template function specialization. I found a discussion about this topic at <a href="http://www.gotw.ca/publications/mill17.htm">http://www.gotw.ca/publications/mill17.htm</a>. The Peter Dimov and Dave Abrahams example shows why template specialization can’t be done with functions.</p>
<p><em>— 15/01/2012</em></p></article><footer class="footer"><div class="footer-contacts"><a href="https://twitter.com/thecybercase" target="_blank" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a href="https://github.com/cybercase" target="_blank" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://it.linkedin.com/pub/stefano-brilli/21/650/953" target="_blank" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a href="mailto:stefano@brilli.me"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></a></div><div>© Stefano Brilli. All Rights Reserved.</div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"sorting_priorities","title":"Sorting Priorities","description":"Template Sorting in C++","date":"2012-01-15T00:00:01.000Z","content":"\u003ch1\u003eSorting Priorities\u003c/h1\u003e\n\u003cp\u003eLet’s say you have your 3d colored point type:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-arduino\"\u003e\u003cspan class=\"hljs-keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eMyPoint\u003c/span\u003e\n{\n    \u003cspan class=\"hljs-comment\"\u003e// A 3d colored point\u003c/span\u003e\n    \u003cspan class=\"hljs-built_in\"\u003eMyPoint\u003c/span\u003e(\u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e c, \u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e x, \u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e y, \u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e d) :\n             \u003cspan class=\"hljs-built_in\"\u003ecolor\u003c/span\u003e(c), \u003cspan class=\"hljs-built_in\"\u003ex\u003c/span\u003e(x), \u003cspan class=\"hljs-built_in\"\u003ey\u003c/span\u003e(y), \u003cspan class=\"hljs-built_in\"\u003ed\u003c/span\u003e(d) {}\n    \u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e color;\n    \u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e x;\n    \u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e y;\n    \u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e d;\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou define a vector of \u003ccode\u003eMyPoint\u003c/code\u003e objects carefully ordered by color, depth, height and width.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ini\"\u003eint \u003cspan class=\"hljs-attr\"\u003ewidth\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\nint \u003cspan class=\"hljs-attr\"\u003eheight\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\nint \u003cspan class=\"hljs-attr\"\u003edepth\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\nint \u003cspan class=\"hljs-attr\"\u003ecolors\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\n\nint \u003cspan class=\"hljs-attr\"\u003elen\u003c/span\u003e = width * height * colors * depth\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\nstd::vector\u0026#x3C;MyPoint\u003e pts\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\npts.reserve(len)\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\n\nfor (int \u003cspan class=\"hljs-attr\"\u003ec\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e; c\u0026#x3C;colors; ++c)\u003c/span\u003e\n    for (int \u003cspan class=\"hljs-attr\"\u003ed\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e; d\u0026#x3C;depth; ++d)\u003c/span\u003e\n        for (int \u003cspan class=\"hljs-attr\"\u003ey\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e; y\u0026#x3C;height; ++y)\u003c/span\u003e\n            for (int \u003cspan class=\"hljs-attr\"\u003ex\u003c/span\u003e=\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e; x\u0026#x3C;width; ++x)\u003c/span\u003e\n                pts.push_back(MyPoint(c, x, y, d))\u003cspan class=\"hljs-comment\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThen one of your funny colleagues put a\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-css\"\u003estd::\u003cspan class=\"hljs-built_in\"\u003erandom_shuffle\u003c/span\u003e(pts.\u003cspan class=\"hljs-built_in\"\u003ebegin\u003c/span\u003e(), pts.\u003cspan class=\"hljs-built_in\"\u003eend\u003c/span\u003e());\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ejust the line before you are scanning the ordered array of \u003ccode\u003eMyPoint\u003c/code\u003e… If it’s not a colleague, could be that you need to apply a transformation matrix to all of your points, or whatever else that will break the color, depth, height and width ordering of your set.\u003c/p\u003e\n\u003cp\u003eTo order back your vector by the same priorities, you can use the STL sort algorithm with some custom comparison function.\nThe the first function I wrote was this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-kotlin\"\u003ebool mypoint_all_sort_fn(\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p0, \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p1)\n{\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (p0.color \u0026#x3C; p1.color)\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (p0.color == p1.color)\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (p0.d \u0026#x3C; p1.d)\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (p0.d == p1.d)\n            \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (p0.y \u0026#x3C; p1.y)\n                \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e;\n            \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (p0.y == p1.y)\n                \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (p0.x \u0026#x3C; p1.x)\n                    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eand then \u003ccode\u003estd::sort(pts.begin(), pts.end(), mypoint_all_sort_fn);\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eI found this solution the ugliest among the others. It’s not scalable, has too many indentations and strong code dependancy… And also if \u003ccode\u003emypoint_all_sort_fn\u003c/code\u003e was defined as operator inside \u003ccode\u003eMyStruct\u003c/code\u003e declaration I wouldn’t like to have such a function inside my software.\u003c/p\u003e\n\u003cp\u003eThe second solution I came to was using several \u003ccode\u003estable_sort\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-arduino\"\u003e\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-type\"\u003ebool\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emypoint_x_sort_fn\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p0, \u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p1)\u003c/span\u003e\n\u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e p0.x \u0026#x3C; p1.x;\n}\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-type\"\u003ebool\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emypoint_y_sort_fn\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p0, \u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p1)\u003c/span\u003e\n\u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e p0.y \u0026#x3C; p1.y;\n}\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-type\"\u003ebool\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emypoint_d_sort_fn\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p0, \u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p1)\u003c/span\u003e\n\u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e p0.d \u0026#x3C; p1.d;\n}\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-type\"\u003ebool\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emypoint_c_sort_fn\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p0, \u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p1)\u003c/span\u003e\n\u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e p0.color \u0026#x3C; p1.color;\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eand then\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-css\"\u003estd::\u003cspan class=\"hljs-built_in\"\u003estable_sort\u003c/span\u003e(pts.\u003cspan class=\"hljs-built_in\"\u003ebegin\u003c/span\u003e(), pts.\u003cspan class=\"hljs-built_in\"\u003eend\u003c/span\u003e(), mypoint_x_sort_fn);\nstd::\u003cspan class=\"hljs-built_in\"\u003estable_sort\u003c/span\u003e(pts.\u003cspan class=\"hljs-built_in\"\u003ebegin\u003c/span\u003e(), pts.\u003cspan class=\"hljs-built_in\"\u003eend\u003c/span\u003e(), mypoint_y_sort_fn);\nstd::\u003cspan class=\"hljs-built_in\"\u003estable_sort\u003c/span\u003e(pts.\u003cspan class=\"hljs-built_in\"\u003ebegin\u003c/span\u003e(), pts.\u003cspan class=\"hljs-built_in\"\u003eend\u003c/span\u003e(), mypoint_d_sort_fn);\nstd::\u003cspan class=\"hljs-built_in\"\u003estable_sort\u003c/span\u003e(pts.\u003cspan class=\"hljs-built_in\"\u003ebegin\u003c/span\u003e(), pts.\u003cspan class=\"hljs-built_in\"\u003eend\u003c/span\u003e(), mypoint_c_sort_fn);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI found this solution not too bad by the code style point of view, but it’s not the same about performances. More are the values you want to sort by, more are the stable_sort steps you have to do.\u003c/p\u003e\n\u003cp\u003eThe last solution, which I found the most fascinating one, was suggested to me by two of my collegues, and it took me a just a small bunch of time to write the code down.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-arduino\"\u003e\u003cspan class=\"hljs-keyword\"\u003etemplate\u003c/span\u003e \u0026#x3C;\u003cspan class=\"hljs-keyword\"\u003etypename\u003c/span\u003e T\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eelement\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e T\u0026#x26;, \u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e i)\u003c/span\u003e\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003etemplate\u003c/span\u003e \u0026#x3C;\u003cspan class=\"hljs-keyword\"\u003etypename\u003c/span\u003e T, \u003cspan class=\"hljs-type\"\u003eint\u003c/span\u003e I\u003e \u003cspan class=\"hljs-keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eOrderer\u003c/span\u003e\n{\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-type\"\u003estatic\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003ebool\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003ecompare\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e T\u0026#x26; t0, \u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e T\u0026#x26; t1)\u003c/span\u003e\n    \u003c/span\u003e{\n        \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (\u003cspan class=\"hljs-built_in\"\u003eelement\u003c/span\u003e(t0, I) == \u003cspan class=\"hljs-built_in\"\u003eelement\u003c/span\u003e(t1, I))\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Orderer\u0026#x3C;T, I\u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e\u003e::\u003cspan class=\"hljs-built_in\"\u003ecompare\u003c/span\u003e(t0, t1);\n        \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eelement\u003c/span\u003e(t0, I) \u0026#x3C; \u003cspan class=\"hljs-built_in\"\u003eelement\u003c/span\u003e(t1, I);\n    }\n};\n\u003cspan class=\"hljs-keyword\"\u003etemplate\u003c/span\u003e \u0026#x3C;\u003cspan class=\"hljs-keyword\"\u003etypename\u003c/span\u003e T\u003e \u003cspan class=\"hljs-keyword\"\u003estruct\u003c/span\u003e \u003cspan class=\"hljs-title class_\"\u003eOrderer\u003c/span\u003e\u0026#x3C;T, \u003cspan class=\"hljs-number\"\u003e-1\u003c/span\u003e\u003e\n{\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-type\"\u003estatic\u003c/span\u003e \u003cspan class=\"hljs-type\"\u003ebool\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003ecompare\u003c/span\u003e\u003cspan class=\"hljs-params\"\u003e(\u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e T\u0026#x26; t0, \u003cspan class=\"hljs-type\"\u003econst\u003c/span\u003e T\u0026#x26; t1)\u003c/span\u003e\n    \u003c/span\u003e{\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e;\n    }\n};\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eUsing templates it’s possible to make the compiler generate the ugly if-else code. Then the task of providing the right element for the sorting is demanded to an element(int) function. Also, it’s possible substitute the element(int) function with an element(int) member function (or maybe an operator) in \u003ccode\u003eMyPoint\u003c/code\u003e definition. This is how it work:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-csharp\"\u003etemplate \u0026#x3C;\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eelement\u003c/span\u003e\u0026#x3C;\u003cspan class=\"hljs-title\"\u003eMyPoint\u003c/span\u003e\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; p, \u003cspan class=\"hljs-built_in\"\u003eint\u003c/span\u003e i\u003c/span\u003e)\u003c/span\u003e\n{\n    \u003cspan class=\"hljs-comment\"\u003e// Watch out!\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// The higher is the i-value, the most significant is the member\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eswitch\u003c/span\u003e(i)\n    {\n        \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e p.color;\n        \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e p.d;\n        \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e p.y;\n        \u003cspan class=\"hljs-keyword\"\u003ecase\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e p.x;\n        \u003cspan class=\"hljs-literal\"\u003edefault\u003c/span\u003e:\n            \u003cspan class=\"hljs-keyword\"\u003ethrow\u003c/span\u003e std::invalid_argument(\u003cspan class=\"hljs-string\"\u003e\"Undefined element\"\u003c/span\u003e);\n    }\n}\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-built_in\"\u003ebool\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003emypoint_sort\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; t0, \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e MyPoint\u0026#x26; t1\u003c/span\u003e)\u003c/span\u003e\n{\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e Orderer\u0026#x3C;MyPoint, \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\u003e::compare(t0, t1);\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eand then \u003ccode\u003estd::sort(pts.begin(), pts.end(), mypoint_sort);\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eThat’s it! A more readable switch-case statement provides the priority of sorting… and the \u003ccode\u003emypoint_sort\u003c/code\u003e function call the template right specialization of Orderer Struct static compare function.\u003c/p\u003e\n\u003cp\u003eHere how you can find, compile and run the code for this example:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003egit \u003cspan class=\"hljs-built_in\"\u003eclone\u003c/span\u003e git://github.com/cybercase/funproject.git\n\u003cspan class=\"hljs-built_in\"\u003ecd\u003c/span\u003e funproject/other\ng++ order.cpp -o order -Wall\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eOne interesting thing I discovered while writing the code of this example, is that you can’t use template function specialization. I found a discussion about this topic at \u003ca href=\"http://www.gotw.ca/publications/mill17.htm\"\u003ehttp://www.gotw.ca/publications/mill17.htm\u003c/a\u003e. The Peter Dimov and Dave Abrahams example shows why template specialization can’t be done with functions.\u003c/p\u003e\n\u003cp\u003e\u003cem\u003e— 15/01/2012\u003c/em\u003e\u003c/p\u003e"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"sorting_priorities"},"buildId":"gl6wU_kcT8lmZpUDfSzMW","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>